---
title: 2024-07-03
date: 2024-07-03 19:48:51
tags: daily
categories: daily
type: daily
status: done
---

## 账户分类
1. **EOA 外部账户**: 私钥控制，妥善保管，不可恢复
2. **合约账户**：代码控制
二者在 EVM 层面是等效的，都是由 nonce(交易序号)、balance(余额)、storageRoot(状态)、codeHash(代码) 组成，但在表现上存在区别
- 交易只能从 EOA 外部账户发出，合约只能被动地相应执行
- 合约之间的交互通常称为消息，所有的手续费 gas 只能由外部账号支付
![[Pasted image 20240703142041.png]]

## gas 机制
- EVM 的计价规则，有助于维护网络的公平，防止资源滥用以及潜在的恶意攻击与漏洞
- 一般单位是 gwei (1 gwei = 10^-9 ETH ), EVM 规范里定义了操作的 gas 值，复杂度越大，所需 gas 越多，详见: https://www.evm.codes/

### gas 费用如何计算
- EIP1559 之前  
>手续费用 = units of gas used(< gas limit) * gas price单价  (gas limit 和 gas price 由用户指定 )
> 矿工收益 = 手续费用 

- EIP1559 之后
>手续费用 = units of gas used(<gas limit) * (base fee + priority fee)  
>
> 燃烧掉 = base fee * gas used ( base fee 是打包时动态确认的) 
> 
> 矿工收益 = tips fee * gas used
> 
> 用户可以自己指定 gas limit 、 max priority fee (支付给矿工的最大费用)、 max fee
> 需要注意的是必须将参数 gasLimit 设置为一个足够的值， 比如一个合约执行过程涉及到多个操作，设置的 gas limit 不足，那么交易将会执行失败，但过程中已经执行的操作消耗的 gas 并不会退回，相当于白白损失了

参考资料:
https://ethereum.org/en/developers/docs/gas/
https://www.bitget.fit/zh-CN/news/detail/12560603813967



### flashbots
https://www.flashbots.net/